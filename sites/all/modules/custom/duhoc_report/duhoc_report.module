<?php

/*
 * implement hook_menu
 */
function duhoc_report_menu() {
  $items = array();
  $items['add/operator'] = array(
    'title' => 'Add field',
    'page callback' => 'duhoc_report_add_operator',
    'access arguments' => array('access content'),
    'type' => MENU_NORMAL_ITEM,
  );
  return $items;
}

function duhoc_report_add_operator() {
  $view = views_get_view('new_views');
  $view->set_display('default');
  $op = $view -> display['default'];
  $name = $op ->display_options['fields']['php']['label'] ;
  $op ->display_options['fields']['php']['label'] = $name .'ten cua ban';
  $view->set_items_per_page(4);
  $view->pre_execute();
  $view->execute();
  return $view->render();
}


function duhoc_report_views_pre_execute(&$view) {

}

function duhoc_report_form_alter(&$form, &$form_state, $form_id) {


}

function duhoc_report_export_to_excel($content) {
  header("Content-Type:   application/vnd.ms-excel; charset=utf-8");
  header("Content-Disposition: attachment; filename=Report.xls");  //File name extension was wrong
  header("Expires: 0");
  header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
  header("Cache-Control: private",false);
  echo $content;
  exit;
}

/**
 * implement hook block_info
 */

function duhoc_report_block_info() {
  $blocks['menu_report'] = array(
    'info' => t('Menu left report'),
  );
  return $blocks;
}

/**
 * implement hook_block_view
 */

function duhoc_report_block_view($delta = '') {
  $block = array();
  switch ($delta) {
    case 'menu_report':
      $block['content'] = duhoc_report_menu_left();
      break;
  }
  return $block;
}

